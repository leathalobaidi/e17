<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Client Success Metrics — E17Studios Admin</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--bg:#09090f;--surface:#111118;--surface2:#16161f;--border:#25253a;--text:#e8e8f0;--muted:#8888a0;--dim:#55556a;--accent:#e74c3c;--green:#2ecc71;--blue:#3498db;--gold:#f39c12;--purple:#9b59b6;--teal:#1abc9c;--radius:12px}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:var(--bg);color:var(--text);display:flex;min-height:100vh}
        a{text-decoration:none;color:inherit}

        .sidebar{width:260px;min-width:260px;background:var(--surface);border-right:1px solid var(--border);position:fixed;top:0;left:0;bottom:0;overflow-y:auto;padding:20px 0}
        .sidebar-logo{padding:0 20px 20px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:10px;margin-bottom:16px}
        .logo-mark{width:36px;height:36px;background:linear-gradient(135deg,var(--accent),#c0392b);border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:.75rem;color:#fff}
        .logo-text{font-weight:800;font-size:1.05rem}.logo-text span{color:var(--accent)}
        .nav-group{margin-bottom:8px;padding:0 12px}
        .nav-label{font-size:.65rem;text-transform:uppercase;letter-spacing:.1em;color:var(--dim);padding:12px 8px 6px;font-weight:700}
        .nav-link{display:flex;align-items:center;gap:10px;padding:8px 12px;border-radius:8px;font-size:.82rem;color:var(--muted);transition:all .15s;font-weight:500}
        .nav-link:hover{background:rgba(255,255,255,.04);color:var(--text)}
        .nav-link.active{background:rgba(231,76,60,.12);color:var(--accent);font-weight:600}

        .main{margin-left:260px;flex:1;padding:32px}
        .container{max-width:1160px;margin:0 auto}

        .page-header{display:flex;justify-content:space-between;align-items:start;margin-bottom:32px;flex-wrap:wrap;gap:16px}
        .page-header h1{font-size:1.8rem;font-weight:900;margin-bottom:4px}
        .page-header p{color:var(--muted);font-size:.88rem}
        .header-actions{display:flex;gap:8px;align-items:center}
        .header-btn{padding:10px 20px;border-radius:10px;font-weight:700;font-size:.82rem;border:1px solid var(--border);background:transparent;color:var(--muted);cursor:pointer;transition:all .15s}
        .header-btn:hover{border-color:var(--accent);color:var(--accent)}
        .header-btn.primary{background:var(--accent);border-color:var(--accent);color:#fff}
        .header-btn.primary:hover{background:#c0392b}

        /* Summary KPIs */
        .summary-row{display:grid;grid-template-columns:repeat(5,1fr);gap:12px;margin-bottom:28px}
        .kpi{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:20px;text-align:center}
        .kpi-icon{font-size:1.4rem;margin-bottom:6px}
        .kpi-num{font-size:1.7rem;font-weight:900}
        .kpi-label{font-size:.67rem;color:var(--muted);text-transform:uppercase;letter-spacing:.04em;margin-top:2px}
        .kpi-change{font-size:.72rem;margin-top:4px;font-weight:600}
        .up{color:var(--green)}.down{color:var(--accent)}

        /* Client cards */
        .clients-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;flex-wrap:wrap;gap:12px}
        .clients-header h2{font-size:1.1rem;font-weight:800}
        .view-controls{display:flex;gap:6px}
        .view-btn{padding:7px 16px;border-radius:8px;border:1px solid var(--border);background:transparent;color:var(--muted);font-size:.75rem;font-weight:600;cursor:pointer;transition:all .15s}
        .view-btn.active,.view-btn:hover{border-color:var(--accent);color:var(--accent);background:rgba(231,76,60,.08)}

        .client-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:16px;margin-bottom:28px}
        .client-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:22px;transition:all .2s}
        .client-card:hover{border-color:rgba(255,255,255,.12)}

        .client-card-header{display:flex;justify-content:space-between;align-items:start;margin-bottom:16px}
        .client-info h3{font-size:.95rem;font-weight:800;margin-bottom:2px}
        .client-type{font-size:.72rem;color:var(--muted)}
        .client-tenure{font-size:.68rem;color:var(--dim);margin-top:2px}

        .health-badge{padding:5px 12px;border-radius:20px;font-size:.68rem;font-weight:700;text-transform:uppercase;letter-spacing:.04em}
        .health-excellent{background:rgba(46,204,113,.15);color:var(--green)}
        .health-good{background:rgba(26,188,156,.15);color:var(--teal)}
        .health-fair{background:rgba(243,156,18,.15);color:var(--gold)}
        .health-risk{background:rgba(231,76,60,.15);color:var(--accent)}

        .client-metrics{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:16px}
        .metric-box{background:var(--surface2);border-radius:8px;padding:12px;text-align:center}
        .metric-val{font-size:1.15rem;font-weight:900}
        .metric-key{font-size:.62rem;color:var(--muted);text-transform:uppercase;letter-spacing:.04em;margin-top:2px;line-height:1.3}
        .metric-delta{font-size:.68rem;font-weight:700;margin-top:3px}

        .mini-bar-wrap{margin-bottom:14px}
        .mini-bar-label{display:flex;justify-content:space-between;font-size:.72rem;color:var(--muted);margin-bottom:4px}
        .mini-bar-label strong{color:var(--text)}
        .mini-bar{height:5px;background:var(--surface2);border-radius:3px;overflow:hidden}
        .mini-bar-fill{height:100%;border-radius:3px;transition:width .4s}

        .client-card-footer{display:flex;justify-content:space-between;align-items:center;padding-top:14px;border-top:1px solid var(--border)}
        .next-action{font-size:.75rem;color:var(--muted)}
        .next-action strong{color:var(--text)}
        .card-actions{display:flex;gap:6px}
        .card-btn{padding:5px 12px;border-radius:6px;border:1px solid var(--border);background:transparent;color:var(--muted);font-size:.7rem;cursor:pointer;transition:all .15s;font-weight:600}
        .card-btn:hover{border-color:var(--accent);color:var(--accent)}
        .card-btn.primary-sm{background:var(--accent);border-color:var(--accent);color:#fff}
        .card-btn.primary-sm:hover{background:#c0392b}

        /* Retention risk panel */
        .risk-panel{background:var(--surface);border:1px solid rgba(231,76,60,.25);border-radius:var(--radius);padding:22px;margin-bottom:28px}
        .risk-header{display:flex;align-items:center;gap:10px;margin-bottom:16px}
        .risk-header h2{font-size:1rem;font-weight:800}
        .risk-alert-dot{width:10px;height:10px;background:var(--accent);border-radius:50%;animation:pulse 2s infinite}
        @keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}
        .risk-items{display:flex;flex-direction:column;gap:10px}
        .risk-item{display:flex;align-items:center;gap:14px;background:var(--surface2);border-radius:10px;padding:14px 18px}
        .risk-name{flex:1;font-size:.85rem;font-weight:700}
        .risk-reason{flex:2;font-size:.78rem;color:var(--muted)}
        .risk-action{flex:1;font-size:.78rem;font-weight:600;color:var(--accent);text-align:right}

        /* MRR chart */
        .charts-row{display:grid;grid-template-columns:2fr 1fr;gap:16px;margin-bottom:28px}
        .chart-card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:22px}
        .chart-card h2{font-size:1rem;font-weight:800;margin-bottom:20px}

        .bar-chart{display:flex;align-items:flex-end;gap:10px;height:140px}
        .bar-group{flex:1;display:flex;flex-direction:column;align-items:center;gap:6px}
        .bar-col{width:100%;background:linear-gradient(180deg,var(--accent),#c0392b);border-radius:4px 4px 0 0;min-height:4px;transition:height .4s}
        .bar-label{font-size:.62rem;color:var(--dim);text-align:center}
        .bar-value{font-size:.68rem;color:var(--muted);font-weight:600}

        .donut-wrap{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%}
        .donut{position:relative;width:120px;height:120px;margin-bottom:16px}
        .donut svg{transform:rotate(-90deg)}
        .donut-label{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center}
        .donut-label .big{font-size:1.3rem;font-weight:900}
        .donut-label .sm{font-size:.65rem;color:var(--muted)}
        .donut-legend{display:flex;flex-direction:column;gap:8px;width:100%}
        .donut-item{display:flex;align-items:center;gap:8px;font-size:.75rem}
        .donut-dot{width:10px;height:10px;border-radius:3px;flex-shrink:0}

        /* Milestones */
        .milestones-section{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:22px}
        .milestones-section h2{font-size:1rem;font-weight:800;margin-bottom:16px}
        .milestone-list{display:flex;flex-direction:column;gap:10px}
        .milestone-item{display:flex;align-items:center;gap:14px;padding:12px 16px;background:var(--surface2);border-radius:10px}
        .ms-icon{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.9rem;flex-shrink:0}
        .ms-achieved{background:rgba(46,204,113,.15)}
        .ms-upcoming{background:rgba(52,152,219,.15)}
        .ms-info{flex:1}
        .ms-info strong{font-size:.85rem;display:block;margin-bottom:2px}
        .ms-info span{font-size:.73rem;color:var(--muted)}
        .ms-date{font-size:.73rem;color:var(--dim);white-space:nowrap}
        .ms-badge{padding:3px 10px;border-radius:20px;font-size:.65rem;font-weight:700;white-space:nowrap}
        .badge-done{background:rgba(46,204,113,.15);color:var(--green)}
        .badge-soon{background:rgba(52,152,219,.15);color:var(--blue)}
        .badge-pending{background:rgba(136,136,160,.1);color:var(--muted)}

        @media(max-width:1024px){.sidebar{display:none}.main{margin-left:0}}
        @media(max-width:900px){.client-grid{grid-template-columns:1fr}.charts-row{grid-template-columns:1fr}.summary-row{grid-template-columns:repeat(3,1fr)}}
        @media(max-width:600px){.client-metrics{grid-template-columns:repeat(2,1fr)}.summary-row{grid-template-columns:repeat(2,1fr)}}
    </style>
</head>
<body>

<aside class="sidebar">
    <div class="sidebar-logo"><div class="logo-mark">E17</div><div class="logo-text">E17<span>Studios</span></div></div>
    <nav>
        <div class="nav-group">
            <div class="nav-label">Pipeline</div>
            <a href="/admin/" class="nav-link">&#9633; CRM Dashboard</a>
            <a href="/admin/analytics.html" class="nav-link">&#9672; Analytics</a>
            <a href="/admin/lead-scoring.html" class="nav-link">&#9733; Lead Scoring</a>
        </div>
        <div class="nav-group">
            <div class="nav-label">Client Success</div>
            <a href="/admin/client-success.html" class="nav-link active">&#9650; Success Metrics</a>
            <a href="/admin/client-report.html" class="nav-link">&#9635; Client Report</a>
            <a href="/admin/client-dashboard.html" class="nav-link">&#9638; Client Dashboard</a>
            <a href="/admin/expansion-planner.html" class="nav-link">&#9736; Expansion Planner</a>
        </div>
        <div class="nav-group">
            <div class="nav-label">Sales Tools</div>
            <a href="/admin/gbp-optimizer.html" class="nav-link">&#10003; GBP Optimizer</a>
            <a href="/admin/proposal-generator.html" class="nav-link">&#9998; Proposal Generator</a>
            <a href="/admin/roi-calculator.html" class="nav-link">&#9736; ROI Calculator</a>
            <a href="/admin/sequence-builder.html" class="nav-link">&#9993; Sequence Builder</a>
        </div>
        <div class="nav-group">
            <div class="nav-label">Navigation</div>
            <a href="/sitemap.html" class="nav-link">&#9776; Sitemap</a>
        </div>
    </nav>
</aside>

<main class="main">
    <div class="container">

        <div class="page-header">
            <div>
                <h1>Client Success Metrics</h1>
                <p>Track performance, health scores, and retention risk across all active clients.</p>
            </div>
            <div class="header-actions">
                <select class="header-btn" id="periodSelect" onchange="updatePeriod(this.value)" style="appearance:none;padding-right:30px;cursor:pointer">
                    <option value="30">Last 30 days</option>
                    <option value="60">Last 60 days</option>
                    <option value="90" selected>Last 90 days</option>
                </select>
                <button class="header-btn primary" onclick="exportReport()">Export Report</button>
            </div>
        </div>

        <!-- Summary KPIs -->
        <div class="summary-row">
            <div class="kpi">
                <div class="kpi-icon">&#128101;</div>
                <div class="kpi-num" style="color:var(--accent)">6</div>
                <div class="kpi-label">Active Clients</div>
                <div class="kpi-change up">&#9650; +2 this quarter</div>
            </div>
            <div class="kpi">
                <div class="kpi-icon">&#128176;</div>
                <div class="kpi-num" style="color:var(--green)">£1,740</div>
                <div class="kpi-label">Monthly Recurring</div>
                <div class="kpi-change up">&#9650; +£290 vs last month</div>
            </div>
            <div class="kpi">
                <div class="kpi-icon">&#128200;</div>
                <div class="kpi-num" style="color:var(--blue)">84%</div>
                <div class="kpi-label">Avg Health Score</div>
                <div class="kpi-change up">&#9650; +6pts vs last quarter</div>
            </div>
            <div class="kpi">
                <div class="kpi-icon">&#128279;</div>
                <div class="kpi-num" style="color:var(--teal)">2,841</div>
                <div class="kpi-label">Total GBP Views</div>
                <div class="kpi-change up">&#9650; +38% vs prior period</div>
            </div>
            <div class="kpi">
                <div class="kpi-icon">&#128222;</div>
                <div class="kpi-num" style="color:var(--gold)">127</div>
                <div class="kpi-label">Tracked Calls/Leads</div>
                <div class="kpi-change up">&#9650; +22 this period</div>
            </div>
        </div>

        <!-- Retention risk panel -->
        <div class="risk-panel">
            <div class="risk-header">
                <div class="risk-alert-dot"></div>
                <h2>Retention Risk — Action Required</h2>
            </div>
            <div class="risk-items">
                <div class="risk-item">
                    <div class="risk-name">Apollo Dry Cleaners</div>
                    <div class="risk-reason">No website update in 6 weeks. GBP views declining (-18%). Owner mentioned "not sure it's worth it" last call.</div>
                    <div class="risk-action">Schedule check-in call &rarr;</div>
                </div>
                <div class="risk-item">
                    <div class="risk-name">Lagoon Eco-Friendly</div>
                    <div class="risk-reason">Month 3 review coming up. Performance strong but no upsell conversation yet — risk of them feeling "static".</div>
                    <div class="risk-action">Prepare expansion pitch &rarr;</div>
                </div>
            </div>
        </div>

        <!-- MRR trend + plan mix -->
        <div class="charts-row">
            <div class="chart-card">
                <h2>MRR Growth</h2>
                <div class="bar-chart" id="mrrChart">
                    <!-- Rendered by JS -->
                </div>
                <div style="display:flex;justify-content:space-between;margin-top:8px">
                    <span id="mrrMonths" style="display:flex;gap:0;width:100%;justify-content:space-around"></span>
                </div>
            </div>
            <div class="chart-card">
                <h2>Plan Mix</h2>
                <div class="donut-wrap">
                    <div class="donut">
                        <svg width="120" height="120" viewBox="0 0 120 120">
                            <circle cx="60" cy="60" r="48" fill="none" stroke="var(--surface2)" stroke-width="14"/>
                            <!-- Starter: 2/6 = 33% · 301.6px circumference -->
                            <circle cx="60" cy="60" r="48" fill="none" stroke="var(--blue)" stroke-width="14" stroke-dasharray="100 201.6" stroke-dashoffset="0"/>
                            <!-- Growth: 3/6 = 50% -->
                            <circle cx="60" cy="60" r="48" fill="none" stroke="var(--accent)" stroke-width="14" stroke-dasharray="150.8 150.8" stroke-dashoffset="-100"/>
                            <!-- Pro: 1/6 = 17% -->
                            <circle cx="60" cy="60" r="48" fill="none" stroke="var(--green)" stroke-width="14" stroke-dasharray="50.2 250.8" stroke-dashoffset="-250.8"/>
                        </svg>
                        <div class="donut-label"><div class="big">6</div><div class="sm">clients</div></div>
                    </div>
                    <div class="donut-legend">
                        <div class="donut-item"><div class="donut-dot" style="background:var(--blue)"></div><span>Starter (£199) — 2 clients</span></div>
                        <div class="donut-item"><div class="donut-dot" style="background:var(--accent)"></div><span>Growth (£299) — 3 clients</span></div>
                        <div class="donut-item"><div class="donut-dot" style="background:var(--green)"></div><span>Pro (£399) — 1 client</span></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Client cards -->
        <div class="clients-header">
            <h2>All Clients</h2>
            <div class="view-controls">
                <button class="view-btn active" onclick="sortClients('health',this)">By Health</button>
                <button class="view-btn" onclick="sortClients('tenure',this)">By Tenure</button>
                <button class="view-btn" onclick="sortClients('mrr',this)">By MRR</button>
            </div>
        </div>

        <div class="client-grid" id="clientGrid">

            <div class="client-card" data-health="95" data-tenure="5" data-mrr="399">
                <div class="client-card-header">
                    <div class="client-info">
                        <h3>Morris Dry Cleaners</h3>
                        <div class="client-type">Dry Cleaners · E17</div>
                        <div class="client-tenure">Client since Sep 2024 · 5 months</div>
                    </div>
                    <span class="health-badge health-excellent">Excellent</span>
                </div>
                <div class="client-metrics">
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--blue)">612</div>
                        <div class="metric-key">GBP Views</div>
                        <div class="metric-delta up">&#9650; +44%</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--green)">38</div>
                        <div class="metric-key">Calls Tracked</div>
                        <div class="metric-delta up">&#9650; +12</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--gold)">4.9&#9733;</div>
                        <div class="metric-key">GBP Rating</div>
                        <div class="metric-delta" style="color:var(--dim)">&#8722; stable</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--accent)">£399</div>
                        <div class="metric-key">Monthly Plan</div>
                        <div class="metric-delta" style="color:var(--muted)">Pro</div>
                    </div>
                </div>
                <div class="mini-bar-wrap">
                    <div class="mini-bar-label"><span>Health Score</span><strong>95/100</strong></div>
                    <div class="mini-bar"><div class="mini-bar-fill" style="width:95%;background:var(--green)"></div></div>
                </div>
                <div class="mini-bar-wrap">
                    <div class="mini-bar-label"><span>GBP Completeness</span><strong>100%</strong></div>
                    <div class="mini-bar"><div class="mini-bar-fill" style="width:100%;background:var(--teal)"></div></div>
                </div>
                <div class="client-card-footer">
                    <div class="next-action">Next: <strong>Month 6 review · Mar 15</strong></div>
                    <div class="card-actions">
                        <button class="card-btn" onclick="window.location='/admin/client-report.html'">Report</button>
                        <button class="card-btn primary-sm" onclick="window.location='/admin/expansion-planner.html'">Upsell</button>
                    </div>
                </div>
            </div>

            <div class="client-card" data-health="88" data-tenure="4" data-mrr="299">
                <div class="client-card-header">
                    <div class="client-info">
                        <h3>Vanish Dry Cleaners</h3>
                        <div class="client-type">Dry Cleaners · E17</div>
                        <div class="client-tenure">Client since Oct 2024 · 4 months</div>
                    </div>
                    <span class="health-badge health-excellent">Excellent</span>
                </div>
                <div class="client-metrics">
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--blue)">541</div>
                        <div class="metric-key">GBP Views</div>
                        <div class="metric-delta up">&#9650; +61%</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--green)">29</div>
                        <div class="metric-key">Calls Tracked</div>
                        <div class="metric-delta up">&#9650; +9</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--gold)">4.7&#9733;</div>
                        <div class="metric-key">GBP Rating</div>
                        <div class="metric-delta up">&#9650; +0.1</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--accent)">£299</div>
                        <div class="metric-key">Monthly Plan</div>
                        <div class="metric-delta" style="color:var(--muted)">Growth</div>
                    </div>
                </div>
                <div class="mini-bar-wrap">
                    <div class="mini-bar-label"><span>Health Score</span><strong>88/100</strong></div>
                    <div class="mini-bar"><div class="mini-bar-fill" style="width:88%;background:var(--green)"></div></div>
                </div>
                <div class="mini-bar-wrap">
                    <div class="mini-bar-label"><span>GBP Completeness</span><strong>92%</strong></div>
                    <div class="mini-bar"><div class="mini-bar-fill" style="width:92%;background:var(--teal)"></div></div>
                </div>
                <div class="client-card-footer">
                    <div class="next-action">Next: <strong>Review photos upload · this week</strong></div>
                    <div class="card-actions">
                        <button class="card-btn" onclick="window.location='/admin/client-report.html'">Report</button>
                        <button class="card-btn primary-sm" onclick="window.location='/admin/expansion-planner.html'">Upsell</button>
                    </div>
                </div>
            </div>

            <div class="client-card" data-health="82" data-tenure="3" data-mrr="299">
                <div class="client-card-header">
                    <div class="client-info">
                        <h3>Lagoon Eco-Friendly</h3>
                        <div class="client-type">Dry Cleaners · E17</div>
                        <div class="client-tenure">Client since Nov 2024 · 3 months</div>
                    </div>
                    <span class="health-badge health-good">Good</span>
                </div>
                <div class="client-metrics">
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--blue)">488</div>
                        <div class="metric-key">GBP Views</div>
                        <div class="metric-delta up">&#9650; +52%</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--green)">21</div>
                        <div class="metric-key">Calls Tracked</div>
                        <div class="metric-delta up">&#9650; +7</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--gold)">4.8&#9733;</div>
                        <div class="metric-key">GBP Rating</div>
                        <div class="metric-delta" style="color:var(--dim)">&#8722; stable</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--accent)">£299</div>
                        <div class="metric-key">Monthly Plan</div>
                        <div class="metric-delta" style="color:var(--muted)">Growth</div>
                    </div>
                </div>
                <div class="mini-bar-wrap">
                    <div class="mini-bar-label"><span>Health Score</span><strong>82/100</strong></div>
                    <div class="mini-bar"><div class="mini-bar-fill" style="width:82%;background:var(--teal)"></div></div>
                </div>
                <div class="mini-bar-wrap">
                    <div class="mini-bar-label"><span>GBP Completeness</span><strong>85%</strong></div>
                    <div class="mini-bar"><div class="mini-bar-fill" style="width:85%;background:var(--teal)"></div></div>
                </div>
                <div class="client-card-footer">
                    <div class="next-action">Next: <strong>Month 3 review — prepare upsell</strong></div>
                    <div class="card-actions">
                        <button class="card-btn" onclick="window.location='/admin/client-report.html'">Report</button>
                        <button class="card-btn primary-sm" onclick="window.location='/admin/expansion-planner.html'">Upsell</button>
                    </div>
                </div>
            </div>

            <div class="client-card" data-health="79" data-tenure="3" data-mrr="299">
                <div class="client-card-header">
                    <div class="client-info">
                        <h3>Pressed 2 Perfection</h3>
                        <div class="client-type">Dry Cleaners · E17</div>
                        <div class="client-tenure">Client since Nov 2024 · 3 months</div>
                    </div>
                    <span class="health-badge health-good">Good</span>
                </div>
                <div class="client-metrics">
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--blue)">397</div>
                        <div class="metric-key">GBP Views</div>
                        <div class="metric-delta up">&#9650; +33%</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--green)">18</div>
                        <div class="metric-key">Calls Tracked</div>
                        <div class="metric-delta up">&#9650; +5</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--gold)">4.8&#9733;</div>
                        <div class="metric-key">GBP Rating</div>
                        <div class="metric-delta" style="color:var(--dim)">&#8722; stable</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--accent)">£299</div>
                        <div class="metric-key">Monthly Plan</div>
                        <div class="metric-delta" style="color:var(--muted)">Growth</div>
                    </div>
                </div>
                <div class="mini-bar-wrap">
                    <div class="mini-bar-label"><span>Health Score</span><strong>79/100</strong></div>
                    <div class="mini-bar"><div class="mini-bar-fill" style="width:79%;background:var(--teal)"></div></div>
                </div>
                <div class="mini-bar-wrap">
                    <div class="mini-bar-label"><span>GBP Completeness</span><strong>80%</strong></div>
                    <div class="mini-bar"><div class="mini-bar-fill" style="width:80%;background:var(--teal)"></div></div>
                </div>
                <div class="client-card-footer">
                    <div class="next-action">Next: <strong>Add service menu + photos</strong></div>
                    <div class="card-actions">
                        <button class="card-btn" onclick="window.location='/admin/client-report.html'">Report</button>
                        <button class="card-btn" onclick="window.location='/admin/gbp-optimizer.html'">GBP</button>
                    </div>
                </div>
            </div>

            <div class="client-card" data-health="58" data-tenure="2" data-mrr="199">
                <div class="client-card-header">
                    <div class="client-info">
                        <h3>Apollo Dry Cleaners</h3>
                        <div class="client-type">Dry Cleaners · E17</div>
                        <div class="client-tenure">Client since Dec 2024 · 2 months</div>
                    </div>
                    <span class="health-badge health-risk">At Risk</span>
                </div>
                <div class="client-metrics">
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--blue)">204</div>
                        <div class="metric-key">GBP Views</div>
                        <div class="metric-delta down">&#9660; -18%</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--green)">9</div>
                        <div class="metric-key">Calls Tracked</div>
                        <div class="metric-delta down">&#9660; -3</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--gold)">4.1&#9733;</div>
                        <div class="metric-key">GBP Rating</div>
                        <div class="metric-delta" style="color:var(--dim)">&#8722; stable</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--accent)">£199</div>
                        <div class="metric-key">Monthly Plan</div>
                        <div class="metric-delta" style="color:var(--muted)">Starter</div>
                    </div>
                </div>
                <div class="mini-bar-wrap">
                    <div class="mini-bar-label"><span>Health Score</span><strong>58/100</strong></div>
                    <div class="mini-bar"><div class="mini-bar-fill" style="width:58%;background:var(--accent)"></div></div>
                </div>
                <div class="mini-bar-wrap">
                    <div class="mini-bar-label"><span>GBP Completeness</span><strong>62%</strong></div>
                    <div class="mini-bar"><div class="mini-bar-fill" style="width:62%;background:var(--gold)"></div></div>
                </div>
                <div class="client-card-footer">
                    <div class="next-action">Next: <strong>Urgent check-in call needed</strong></div>
                    <div class="card-actions">
                        <button class="card-btn" onclick="window.location='/admin/client-report.html'">Report</button>
                        <button class="card-btn primary-sm" style="background:var(--gold);border-color:var(--gold)" onclick="scheduleCall('Apollo')">Call Now</button>
                    </div>
                </div>
            </div>

            <div class="client-card" data-health="72" data-tenure="1" data-mrr="199">
                <div class="client-card-header">
                    <div class="client-info">
                        <h3>Supreme Dry Cleaners</h3>
                        <div class="client-type">Dry Cleaners · E17</div>
                        <div class="client-tenure">Client since Jan 2025 · 1 month</div>
                    </div>
                    <span class="health-badge health-fair">Fair</span>
                </div>
                <div class="client-metrics">
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--blue)">199</div>
                        <div class="metric-key">GBP Views</div>
                        <div class="metric-delta up">&#9650; +11%</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--green)">12</div>
                        <div class="metric-key">Calls Tracked</div>
                        <div class="metric-delta up">&#9650; +12</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--gold)">4.8&#9733;</div>
                        <div class="metric-key">GBP Rating</div>
                        <div class="metric-delta" style="color:var(--dim)">&#8722; stable</div>
                    </div>
                    <div class="metric-box">
                        <div class="metric-val" style="color:var(--accent)">£199</div>
                        <div class="metric-key">Monthly Plan</div>
                        <div class="metric-delta" style="color:var(--muted)">Starter</div>
                    </div>
                </div>
                <div class="mini-bar-wrap">
                    <div class="mini-bar-label"><span>Health Score</span><strong>72/100</strong></div>
                    <div class="mini-bar"><div class="mini-bar-fill" style="width:72%;background:var(--gold)"></div></div>
                </div>
                <div class="mini-bar-wrap">
                    <div class="mini-bar-label"><span>GBP Completeness</span><strong>70%</strong></div>
                    <div class="mini-bar"><div class="mini-bar-fill" style="width:70%;background:var(--gold)"></div></div>
                </div>
                <div class="client-card-footer">
                    <div class="next-action">Next: <strong>Complete onboarding checklist</strong></div>
                    <div class="card-actions">
                        <button class="card-btn" onclick="window.location='/admin/client-report.html'">Report</button>
                        <button class="card-btn" onclick="window.location='/onboarding/'">Onboarding</button>
                    </div>
                </div>
            </div>

        </div>

        <!-- Milestones -->
        <div class="milestones-section">
            <h2>Client Milestones &amp; Upcoming Renewals</h2>
            <div class="milestone-list">
                <div class="milestone-item">
                    <div class="ms-icon ms-achieved">&#9989;</div>
                    <div class="ms-info"><strong>Morris Dry Cleaners — 100 GBP reviews milestone</strong><span>Crossed 769 total reviews. Avg rating held at 4.9 — strongest trust signal in E17.</span></div>
                    <div class="ms-date">Feb 2025</div>
                    <span class="ms-badge badge-done">Achieved</span>
                </div>
                <div class="milestone-item">
                    <div class="ms-icon ms-achieved">&#9989;</div>
                    <div class="ms-info"><strong>Vanish — First page 1 ranking</strong><span>"dry cleaners Walthamstow" now position 3 on Google Maps. First paid client to rank page 1.</span></div>
                    <div class="ms-date">Jan 2025</div>
                    <span class="ms-badge badge-done">Achieved</span>
                </div>
                <div class="milestone-item">
                    <div class="ms-icon ms-upcoming">&#128197;</div>
                    <div class="ms-info"><strong>Morris — 6-month renewal &amp; upsell opportunity</strong><span>Upgrade from Pro to bespoke retainer. Pitch Google Ads management as add-on.</span></div>
                    <div class="ms-date">15 Mar 2025</div>
                    <span class="ms-badge badge-soon">In 2 weeks</span>
                </div>
                <div class="milestone-item">
                    <div class="ms-icon ms-upcoming">&#128197;</div>
                    <div class="ms-info"><strong>Lagoon — Month 3 review</strong><span>Strong early results. Pitch Growth &rarr; Pro upgrade with social media calendar add-on.</span></div>
                    <div class="ms-date">28 Feb 2025</div>
                    <span class="ms-badge badge-soon">This week</span>
                </div>
                <div class="milestone-item">
                    <div class="ms-icon ms-upcoming" style="background:rgba(243,156,18,.1)">&#9888;&#65039;</div>
                    <div class="ms-info"><strong>Apollo — 3-month decision point</strong><span>If health score doesn't recover, client may not renew. Must demonstrate ROI clearly.</span></div>
                    <div class="ms-date">28 Feb 2025</div>
                    <span class="ms-badge badge-pending">Needs action</span>
                </div>
            </div>
        </div>

    </div>
</main>

<script>
// MRR chart data
const mrrData = {
    30:  { labels:['Jan 28','Feb 4','Feb 11','Feb 18','Feb 25'], values:[1540,1540,1740,1740,1740] },
    60:  { labels:['Jan','Jan 14','Jan 21','Jan 28','Feb'], values:[1240,1240,1540,1540,1740] },
    90:  { labels:['Nov','Dec','Jan','Jan 21','Feb'], values:[940,1140,1240,1540,1740] }
};

function renderMrrChart(period) {
    const data = mrrData[period] || mrrData[90];
    const chart = document.getElementById('mrrChart');
    const months = document.getElementById('mrrMonths');
    const max = Math.max(...data.values) * 1.1;
    chart.innerHTML = data.values.map((v, i) => `
        <div class="bar-group" style="flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;height:100%;justify-content:flex-end">
            <span style="font-size:.62rem;color:var(--muted);font-weight:600">£${v.toLocaleString()}</span>
            <div style="width:70%;background:linear-gradient(180deg,var(--accent),#c0392b);border-radius:4px 4px 0 0;height:${(v/max)*100}%;min-height:4px"></div>
            <span style="font-size:.6rem;color:var(--dim);text-align:center;white-space:nowrap">${data.labels[i]}</span>
        </div>
    `).join('');
}

function updatePeriod(period) {
    renderMrrChart(parseInt(period));
}

function sortClients(by, btn) {
    document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    const grid = document.getElementById('clientGrid');
    const cards = Array.from(grid.querySelectorAll('.client-card'));
    cards.sort((a, b) => parseInt(b.dataset[by]) - parseInt(a.dataset[by]));
    cards.forEach(c => grid.appendChild(c));
}

function scheduleCall(client) {
    alert(`In production: open calendar to schedule a check-in call with ${client} Dry Cleaners. A task would also be added to your CRM.`);
}

function exportReport() {
    alert('In production: generates a PDF summary of all client metrics, health scores, and milestones — ready to share with a business partner or investor.');
}

// Initial render
renderMrrChart(90);
</script>
</body>
</html>
